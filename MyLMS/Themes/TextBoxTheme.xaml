<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Style TargetType="{x:Type TextBox}"
           x:Key="ModernTextBox">

        <!-- Rimuovi le dimensioni hardcoded per rendere lo stile flessibile -->
        <Setter Property="Width" Value="200"/>
        <Setter Property="Height" Value="25"/>
        <Setter Property="Background" Value="#353340"/>
        <Setter Property="Foreground" Value="#CFCFCF"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Padding" Value="5"/>
        <Setter Property="VerticalContentAlignment" Value="Center"/>

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type TextBox}">
                    <Border CornerRadius="10"
                            Background="{TemplateBinding Background}"
                        Width="{TemplateBinding Width}"
                            Height="{TemplateBinding Height}">

                        <Grid>
                            <!-- TextBox interna con binding TwoWay verso il padre -->
                            <TextBox x:Name="SearchBox"
                                     Margin="1"
                                     FontFamily="Baskerville Old Face"
                                     Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Text, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                     BorderThickness="0"
                                     Background="Transparent"
                                     VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"
                                     Padding="{TemplateBinding Padding}"
                                     Foreground="{TemplateBinding Foreground}"
                                     IsReadOnly="{TemplateBinding IsReadOnly}"
                                     IsEnabled="{TemplateBinding IsEnabled}"/>

                                <!-- Placeholder TextBlock (aggiunto il testo di esempio e migliorati i trigger) -->
                                <TextBlock IsHitTestVisible="False"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Left"
                                       Margin="10,0,0,0"
                                       FontSize="14"
                                       FontFamily="Baskerville Old Face"
                                       Foreground="DarkGray"
                                       Text="">

                                    <TextBlock.Style>
                                        <Style TargetType="{x:Type TextBlock}">
                                            <!-- Nascondi il placeholder quando la TextBox interna ha del testo o ha il focus -->
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                            <Style.Triggers>
                                                <MultiDataTrigger>
                                                    <MultiDataTrigger.Conditions>
                                                        <Condition Binding="{Binding Text, ElementName=SearchBox}" Value=""/>
                                                        <Condition Binding="{Binding IsFocused, ElementName=SearchBox}" Value="False"/>
                                                    </MultiDataTrigger.Conditions>
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                </MultiDataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                        </Grid>
                    </Border>

                    <!-- Trigger standard per gestire lo stato di focus -->
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsFocused" Value="True">
                            <Setter TargetName="SearchBox" Property="FocusManager.FocusedElement" Value="{Binding ElementName=SearchBox}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>